#!/usr/bin/env zsh
# vim: set ft=zsh

zellij-layout-picker() {
  local layout_dir="${ZELLIJ_LAYOUT_DIR:-$XDG_CONFIG_HOME/zellij/layouts}"
  if [[ ! -d "$layout_dir" ]]; then
    echo "cannot find layouts directory: $layout_dir"
    return 1
  fi

  local layout
  layout=$(
    fselect filename from "$layout_dir" where is_file and extension eq "kdl" |
      fzf \
        --query "$1" \
        --preview="/bin/cat $layout_dir/{}.kdl"
  )

  if [[ -n "$layout" ]]; then
    zellij --layout "$layout_dir/$layout.kdl"
    return 0
  fi
  return 1
}
